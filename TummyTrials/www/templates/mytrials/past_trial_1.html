<ion-view>
  <ion-nav-title>
  Past Trials
  </ion-nav-title>
  <ion-pane>
    <ion-content class="padding">
    <h4 class="title">{{st_trigger}} Study Findings</h4>
    Study length {{duration_readable}} days : <b>{{start_date_md}} - {{end_date_md}} </b>
    <br/> <br/>
    
    <!-- <h5 class="title">Description</h5> -->
    <h5>Does {{st_trigger}} affect my <span ng-repeat="symptom in st_symptom"> {{symptom}} &nbsp </span>?</h5><!-- work on punctuation logic --> 
    <br/>

<!--     <h5 class="title">{{text.setup5.symptoms_title}}</h5>
    <span ng-repeat="symptom in st_symptom"> {{symptom}} </span>
    <br/> -->

<!--     <h5 class="title">{{text.setup5.reminder_times_title}}</h5>
    <div class="row" ng-repeat="remdesc in study_past1.remdescrs">
        <div class="col">{{text.setup5[remdesc.type + '_reminder_title'] || remdesc.type}}</div>
        <div class="col">{{study_reminder_times[remdesc.type]}}</div>
    </div>
    <br/> -->

    <!-- <h5 class="title">{{text.pasttrial1.status_title}}</h5> -->
    <!-- <span ng-show="st_status == 'ended'"> This trial has {{st_status}}.</span> -->
    <span ng-show="st_status == 'abandoned'"> This trial was {{st_status}}.</span><span ng-show="st_comment != ''">The reason for abandoning was <i>'{{st_comment}}'</i>.</span>

    <!-- Show results only if study was ended -->
    <div ng-show="st_status == 'ended'">
        <div ng-repeat="(key, value) in visdata">
            <!-- Result for symptom:<br/> -->
            <b>{{key}}</b>
            <hr>
            {{value[0].summary}}. (p={{value[0].p_val}}) <br/><br/>
            <div class="divcenter">
                <!-- {{key}}  -->
                <b><label >{{view_title}}</label></b>
            </div>
            <result-vis result-data="value" on-click="d3OnClick(data_pt)" label="d3Label" control="resultVisControl"> </result-vis>
            <div class="divcenter">
                <button class="button button-small button-royal small-text" ng-click="resultVisControl.updateVis();">&nbsp&nbsp Timeline view &nbsp&nbsp </button> &nbsp&nbsp &nbsp&nbsp 
                <button class="button button-small button-royal small-text" ng-click="resultVisControl.revertVis();">&nbsp&nbsp Trend view &nbsp&nbsp </button>
            </div>
            <br/><br/>
            <div>
<!--                 Average {{key}} severity on days with {{trig}} was 
                {{value[duration_readable - 1].a_avg / ((duration_readable / 2) - value[0].a_void)}} 
                and on days without {{trig}} was 
                {{value[duration_readable - 1].b_avg / ((duration_readable / 2) - value[0].b_void)}} <br/> -->

                Average {{key}} severity on days with {{trig}} was 
                {{value[0].a_res_text}} 
                and on days without {{trig}} was 
                {{value[0].b_res_text}}. <br/><br/>

                <span ng-show="value[0].a_void > 0 || value[0].b_void > 0">There were one or more days when no symptoms were recorded which may affect the averages shown above. Missing data is shown in grey circles in the visualization.</span>
            </div>
            <br/><br/>
        </div>
    </div>

    </ion-content>  
  </ion-pane>
</ion-view>