<ion-view>
  <ion-nav-title>
  Trial Findings
  </ion-nav-title>
  <ion-pane>
    <ion-content class="padding">
    <h4 class="title">{{st_trigger}} Study Findings</h4>
    Study length {{duration_readable}} days : <b>{{start_date_md}} - {{end_date_md}} </b>
    <br/> <br/>
    
    Testing: {{exp_id}} <br/>
    <!-- <h5 class="title">Description</h5> -->
    <h5>Does {{st_trigger}} affect my <span ng-repeat="symptom in st_symptom"> {{symptom}} &nbsp </span>?</h5><!-- work on punctuation logic --> 
    <br/>

    <!-- <h5 class="title">{{text.pasttrial1.status_title}}</h5> -->
    <span ng-show="st_status == 'abandoned'"> This trial was {{st_status}}.</span><span ng-show="st_reason != ''">The reason for abandoning was <i>'{{st_reason}}'</i>.</span>

    <!-- Message while results are being processed -->
    <div ng-show="st_status == 'ended' && !ready">
        <p class="assertive">Your data is being proccessed and your result will be available soon.</p>
    </div>

    <!-- Show results only if study has ended and results are available -->
    <div ng-show="st_status == 'ended' && ready">
        <div ng-repeat="(key, value) in visdata">
            <!-- Result for symptom:<br/> -->
            <b>{{key}}</b>
            <hr>
            {{value[0].summary}}. (p={{value[0].p_val}}) <br/><br/>
            <div class="divcenter">
                <!-- {{key}}  -->
                <b><label >{{view_title}}</label></b>
            </div>

            <!-- Legend for the vis  -->
<!--             <svg height="20" width="100%">
              <circle cx="50" cy="9" r="9" fill="#FFA70F" />
              <text x="65" y="15">: {{trig}} days</text>
              <circle cx="180" cy="9" r="9" fill="#0F85FF" />
              <text x="195" y="15">: No {{trig}} days</text>
            </svg>
 -->
            <!-- Result Vis -->
            <result-vis result-data="value" on-click="d3OnClick(data_pt)" label="d3Label" control="resultVisControl"> </result-vis>
            <div class="button-bar">
                <button class="button button-block button-royal small-text" ng-click="resultVisControl.updateVis();">&nbsp&nbsp Timeline view &nbsp&nbsp </button> &nbsp&nbsp
                <button class="button button-block button-royal small-text" ng-click="resultVisControl.revertVis();">&nbsp&nbsp Trend view &nbsp&nbsp </button>
            </div>
            <br/><br/>
            <div>

            <!-- Decided not to show averages -->
            <!-- Average {{key}} severity on days with {{trig}} was 
                {{value[0].a_res_text}} 
                and on days without {{trig}} was 
                {{value[0].b_res_text}}. <br/><br/> -->

                <span ng-show="value[duration_readable - 1].a_void > 0 || value[duration_readable - 1].b_void > 0">There were one or more days when no symptoms were recorded which may affect the averages shown above. Missing data is shown in grey circles in the visualization.</span>

            </div>
            <br/><br/>
        </div>
    </div>

    </ion-content>  
  </ion-pane>
</ion-view>
