<ion-view title="Current Trial" cache-view="false">
  <ion-pane>
    <ion-content>
    <div class="calendar" ng-show="study_current && !exp_bool">
      <br/><h4 class="padding"> {{title_text}} study</h4>
      <h5 class="padding">Day {{day_num}} of {{duration_readable}}</h5>
      <!--
      Start date : {{start_date_dtonly}}<br/>
      Start date : {{start_date_full}}<br/>
      End date : {{end_date_readable}}<br/>
      Duration : {{duration_readable}}<br/>
      Schedule : {{schedule}}<br/>
      Today:  {{today_readable}}<br/>
      Selected day : {{selected_date}}<br/>
      Row length : {{row_length}} <br/> 
      Reports: {{report}} <br/>
      -->
      <div class="divcenter">
      <div class="button-bar"> 
        <div ng-repeat="day in schedule">
          <a class="button" ng-if="day[0] != today_readable" ng-show="$index < row_length"  ng-class="day[1] == 'A' ? 'button-positive' : 'button-balanced'" ui-sref="calendar">{{day[0]}}</a>
          <a class="button button-energized" ng-if="day[0] == today_readable" ng-show="$index < row_length" ui-sref="calendar">{{day[0]}}</a>
        </div>
      </div>

      <div class="button-bar">
        <div ng-repeat="day in schedule">
          <a class="button" ng-if="day[0] != today_readable" ng-show="$index >= row_length" ng-class="day[1] == 'A' ? 'button-positive' : 'button-balanced'" ui-sref="calendar">{{day[0]}}</a>
          <a class="button button-energized" ng-if="day[0] == today_readable" ng-show="$index >= row_length" ui-sref="calendar">{{day[0]}}</a>
        </div>
      </div>
      </div>
      <br/><br/>

    </div>


    <div class="padding" ng-hide="!study_current">    
    
        <h4 class="title">{{text.current.title}} {{today_full}}</h4>
        {{active_day}}
        {{test2}}
        <!-- 
        Content to display when there is no on going experiment
        --> 
        <div ng-hide="!exp_bool">
          You have an experiment scheduled to begin on {{start_date_full}}. 
        </div>    

        <!-- 
        Content to display when experiment underway
        --> 
        <div ng-show="!exp_bool">
          <p>{{text.current.subtitle}} <b>{{active_text}}</b> {{text.current.subtitle2}}</p>
          <p><a ui-sref="setup_3_2">{{text.current.para1}}</a></p>
          <br/>    
          <h4>Your reminders for today:</h4>
          <!-- XXX In later commit, change contents of the whole page. -->
          <p ng-show="!study_current">(No current trial. Please create a new trial.)</p>
              

              <div ng-repeat="rem in study_reminders">
                  <p>
                  <i class="ion-ios-checkmark" ng-hide="rem.reportdue" style="font-size: 120%;"></i>
                  <i class="ion-ios-circle-outline" ng-show="rem.reportdue" style="font-size: 120%;"></i>
                  {{rem.schedmsg}}
                  <div class="divcenter" ng-show="!!rem.logmsg">
                      <a class="button button-royal" ui-sref="{{rem.logstate}}" ng-disabled="rem.disabled">
                          {{rem.logmsg}}
                      </a>
                  </div>
                  </p>
                  <br/>
              </div>

          <h4>Optional:</h4>
            <p>
              {{text.current.note}}
              <div class="divcenter">
                <a class="button button-royal" ui-sref="notes">
                  {{text.current.button3}}
                </a>
              </div>
            </p>
        </div>
    
    </div>

    <!-- 
    Content to display when there is no on going study
    --> 

      <div class="padding" ng-show="!study_current">
          <h4 class="title">No ongoing trial</h4>
      <br/>
      <p>Would you like to setup a new trial?</p>
      <br/>

      <a class="button button-block button-royal" ui-sref="setup_1">
              Setup a New Trial
          </a>
      </div>    


    </ion-content>  
  </ion-pane>
</ion-view>
